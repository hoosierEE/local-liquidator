<!DOCTYPE HTML>

<html>
    <head>
        <meta charset="UTF-8">
        <title>
            Welcome
        </title>
        <script type="text/javascript" src="/elm-runtime.js">
            
        </script>
        <script type="text/javascript">
            Elm.Main = Elm.Main || {};
Elm.Main.make = function (elm)
                {
                  elm.Main = elm.Main || {};
                  if (elm.Main.values)
                  return elm.Main.values;
                  var N = Elm.Native,
                      _N = N.Utils.make(elm),
                      _L = N.List.make(elm),
                      _E = N.Error.make(elm),
                      _J = N.JavaScript.make(elm),
                      $moduleName = "Main";
                  var Text = Elm.Text.make(elm);
                  var Text = Elm.Text.make(elm);
                  var Basics = Elm.Basics.make(elm);
                  var Signal = Elm.Signal.make(elm);
                  var List = Elm.List.make(elm);
                  var Maybe = Elm.Maybe.make(elm);
                  var Time = Elm.Time.make(elm);
                  var Prelude = Elm.Prelude.make(elm);
                  var Graphics = Graphics || {};
                  Graphics.Element = Elm.Graphics.Element.make(elm);
                  var Color = Elm.Color.make(elm);
                  var Graphics = Graphics || {};
                  Graphics.Collage = Elm.Graphics.Collage.make(elm);
                  var Components = Components || {};
                  Components.UserInput = Elm.Components.UserInput.make(elm);
                  var _op = {};
                  var display = function (a)
                                {
                                  return A2(Graphics.Element.flow,
                                            Graphics.Element.right,
                                            _J.toList([a]));
                                };
                  var main = A2(Signal._op["<~"],display,Components.UserInput.scene);
                  elm.Main.values = {_op: _op, display: display, main: main};
                  return elm.Main.values;
                };Elm.Components = Elm.Components || {};
Elm.Components.UserInput = Elm.Components.UserInput || {};
Elm.Components.UserInput.make = function (elm)
                                {
                                  elm.Components = elm.Components || {};
                                  elm.Components.UserInput = elm.Components.UserInput || {};
                                  if (elm.Components.UserInput.values)
                                  return elm.Components.UserInput.values;
                                  var N = Elm.Native,
                                      _N = N.Utils.make(elm),
                                      _L = N.List.make(elm),
                                      _E = N.Error.make(elm),
                                      _J = N.JavaScript.make(elm),
                                      $moduleName = "Components.UserInput";
                                  var Text = Elm.Text.make(elm);
                                  var Text = Elm.Text.make(elm);
                                  var Basics = Elm.Basics.make(elm);
                                  var Signal = Elm.Signal.make(elm);
                                  var List = Elm.List.make(elm);
                                  var Maybe = Elm.Maybe.make(elm);
                                  var Time = Elm.Time.make(elm);
                                  var Prelude = Elm.Prelude.make(elm);
                                  var Graphics = Graphics || {};
                                  Graphics.Element = Elm.Graphics.Element.make(elm);
                                  var Color = Elm.Color.make(elm);
                                  var Graphics = Graphics || {};
                                  Graphics.Collage = Elm.Graphics.Collage.make(elm);
                                  var Graphics = Graphics || {};
                                  Graphics.Input = Elm.Graphics.Input.make(elm);
                                  var Utils = Utils || {};
                                  Utils.Valid = Elm.Utils.Valid.make(elm);
                                  var _op = {};
                                  var table = F2(function (a,b)
                                                 {
                                                   return function ()
                                                          {
                                                            var rightSide = List.map(function (n)
                                                                                     {
                                                                                       return A3(Graphics.Element.container,
                                                                                                 100,
                                                                                                 38,
                                                                                                 Graphics.Element.midLeft)(A2(Graphics.Element.width,
                                                                                                                              100,
                                                                                                                              n));
                                                                                     });
                                                            var padding = A2(Graphics.Element.spacer,
                                                                             10,
                                                                             10);
                                                            var row = function (arg0)
                                                                      {
                                                                        return function ()
                                                                               {
                                                                                 switch (arg0.ctor)
                                                                                 {case
                                                                                  "_Tuple2" :
                                                                                    return A2(Graphics.Element.flow,
                                                                                              Graphics.Element.right,
                                                                                              _J.toList([arg0._0,
                                                                                                         padding,
                                                                                                         arg0._1]));}
                                                                                 _E.Case($moduleName,
                                                                                         "on line 25, column 29 to 67");
                                                                               }();
                                                                      };
                                                            var leftSide = A2(List.map,
                                                                              function (n)
                                                                              {
                                                                                return A3(Graphics.Element.container,
                                                                                          90,
                                                                                          38,
                                                                                          Graphics.Element.midRight)(Text.plainText(n));
                                                                              },
                                                                              a);
                                                            return Graphics.Element.flow(Graphics.Element.down)(List.map(row)(A2(List.zip,
                                                                                                                                 leftSide,
                                                                                                                                 rightSide(b))));
                                                          }();
                                                 });
                                  var inputHeadings = _J.toList(["Isbn","Price","Minutes"]);
                                  var tableS = function (z)
                                               {
                                                 return A2(table,inputHeadings,z);
                                               };
                                  var $ = Graphics.Input.button("Sell"),
                                      sellBtn = $._0,
                                      sellSignal = $._1;
                                  var $ = Graphics.Input.field("Price"),
                                      priceField = $._0,
                                      priceSignal = $._1;
                                  var $ = Graphics.Input.field("ISBN Number"),
                                      isbnField = $._0,
                                      isbnSignal = $._1;
                                  var $ = Graphics.Input.field("Expire Minutes"),
                                      expireField = $._0,
                                      expireSignal = $._1;
                                  var ins = Signal.combine(_J.toList([isbnField,
                                                                      priceField,
                                                                      expireField]));
                                  var validSignals = _J.toList([A2(Signal._op["<~"],
                                                                   Utils.Valid.isbn,
                                                                   isbnSignal),
                                                                A2(Signal._op["<~"],
                                                                   Utils.Valid.price,
                                                                   priceSignal),
                                                                A2(Signal._op["<~"],
                                                                   Utils.Valid.expire,
                                                                   expireSignal)]);
                                  var preview = Signal.combine(A2(List.map,
                                                                  function (n)
                                                                  {
                                                                    return A2(Signal.lift,
                                                                              Text.plainText,
                                                                              n);
                                                                  },
                                                                  validSignals));
                                  var $ = Graphics.Input.button("Buy"),
                                      buyBtn = $._0,
                                      buySignal = $._1;
                                  var btns = Signal.constant(A2(Graphics.Element.flow,
                                                                Graphics.Element.right,
                                                                _J.toList([buyBtn,sellBtn])));
                                  var scene = A2(Signal._op["<~"],
                                                 Graphics.Element.flow(Graphics.Element.down),
                                                 Signal.combine(_J.toList([A2(Signal._op["<~"],
                                                                              tableS,
                                                                              ins),
                                                                           btns,
                                                                           A2(Signal._op["<~"],
                                                                              tableS,
                                                                              preview)])));
                                  elm.Components.UserInput.values = {_op: _op, scene: scene, validSignals: validSignals};
                                  return elm.Components.UserInput.values;
                                };Elm.Utils = Elm.Utils || {};
Elm.Utils.Valid = Elm.Utils.Valid || {};
Elm.Utils.Valid.make = function (elm)
                       {
                         elm.Utils = elm.Utils || {};
                         elm.Utils.Valid = elm.Utils.Valid || {};
                         if (elm.Utils.Valid.values)
                         return elm.Utils.Valid.values;
                         var N = Elm.Native,
                             _N = N.Utils.make(elm),
                             _L = N.List.make(elm),
                             _E = N.Error.make(elm),
                             _J = N.JavaScript.make(elm),
                             $moduleName = "Utils.Valid";
                         var Text = Elm.Text.make(elm);
                         var Text = Elm.Text.make(elm);
                         var Basics = Elm.Basics.make(elm);
                         var Signal = Elm.Signal.make(elm);
                         var List = Elm.List.make(elm);
                         var Maybe = Elm.Maybe.make(elm);
                         var Time = Elm.Time.make(elm);
                         var Prelude = Elm.Prelude.make(elm);
                         var Graphics = Graphics || {};
                         Graphics.Element = Elm.Graphics.Element.make(elm);
                         var Color = Elm.Color.make(elm);
                         var Graphics = Graphics || {};
                         Graphics.Collage = Elm.Graphics.Collage.make(elm);
                         var String = Elm.String.make(elm);
                         var Char = Elm.Char.make(elm);
                         var Maybe = Elm.Maybe.make(elm);
                         var _op = {};
                         var price = function (str)
                                     {
                                       return function ()
                                              {
                                                var _case0 = String.toFloat(str);
                                                switch (_case0.ctor)
                                                {case
                                                 "Just" :
                                                   return function ()
                                                          {
                                                            var currency = function (s)
                                                                           {
                                                                             return Basics.toFloat(Basics.round(s * 100)) / 100;
                                                                           };
                                                            return Prelude.show(currency(_case0._0));
                                                          }();
                                                 case
                                                 "Nothing" :
                                                   return "0";}
                                                _E.Case($moduleName,"between lines 15 and 18");
                                              }();
                                     };
                         var isbn = function (str)
                                    {
                                      return function ()
                                             {
                                               var isbnDigits = A2(String.filter,Char.isDigit,str);
                                               var len = String.length(isbnDigits);
                                               return _N.eq(len,9) ? _L.append(isbnDigits,
                                                                               "X") : _N.eq(len,
                                                                                            10) || _N.eq(len,
                                                                                                         13) ? isbnDigits : "";
                                             }();
                                    };
                         var expire = function (str)
                                      {
                                        return function ()
                                               {
                                                 var maxTime = "10080";
                                                 var defaultTime = "60";
                                                 return function ()
                                                        {
                                                          var _case2 = String.toInt(str);
                                                          switch (_case2.ctor)
                                                          {case
                                                           "Just" :
                                                             return _N.cmp(_case2._0,
                                                                           0) > -1 && _N.cmp(_case2._0,
                                                                                             10080) < 1 ? Prelude.show(_case2._0) : _N.cmp(_case2._0,
                                                                                                                                           10080) > 0 ? maxTime : defaultTime;
                                                           case
                                                           "Nothing" :
                                                             return defaultTime;}
                                                          _E.Case($moduleName,
                                                                  "between lines 24 and 29");
                                                        }();
                                               }();
                                      };
                         var btnClicked = function (btnPress)
                                          {
                                            return function ()
                                                   {
                                                     var always = F2(function (value,signal)
                                                                     {
                                                                       return A2(Signal.lift,
                                                                                 function (arg0)
                                                                                 {
                                                                                   return function ()
                                                                                          {
                                                                                            return value;
                                                                                          }();
                                                                                 },
                                                                                 signal);
                                                                     });
                                                     return A2(Signal.merge,
                                                               A2(always,
                                                                  false,
                                                                  A2(Time.delay,0,btnPress)),
                                                               A2(always,true,btnPress));
                                                   }();
                                          };
                         elm.Utils.Valid.values = {_op: _op, isbn: isbn, price: price, expire: expire, btnClicked: btnClicked};
                         return elm.Utils.Valid.values;
                       };
        </script>
    </head>
    <body>
        <script type="text/javascript">
            Elm.fullscreen(Elm.Main)
        </script>
        <noscript>
            
        </noscript>
    </body>
</html>
